![polish_powershell_group_pposh_logo2](https://cloud.githubusercontent.com/assets/19157221/25561611/52b4cd36-2d70-11e7-8c8f-907dfd947524.png)

# Introduction do PowerShell DSC

DSC was one of the topics covered on the first Polish PowerShell User Group meeting :) 

## Thank you all for joining!

On the first meeting I have highlited what is DSC, how to install it and what are the capabilities.

I would like to continue with the subject of DSC and focus on aspects like HA cluster for HTTPS pull server, building advanced pull servers on windows core, present available resources, using Linux as authoring workstation (also covering  PowerShell on Linux thing), etc.

At the end of the path I would like us to go through complete roadmap of DSC available features and configuration options so we together have it sorted out when comes to implement it in our environment.

All of this would be documented on this PPOSH GitHub and my private blog https://paweljarosz.wordpress.com

This resource contains:
1. Presentation from the first PPOSH meeting
2. Instructions how to build first HTTPS DSC Pull Server
3. Instructions how to apply basic configuration on Windows and Linux clients

## Creating a test lab

To create a test lab for this I would suggest having 3 machines:

1. LABDSCPS01 – W2016 / DSC HTTPS Pull Server (192.168.0.33)
2. LABDC01 – W2016 / DC / DSC Windows client (192.168.0.31)
3. LABCENTOS01 – Centos 7 / DSC Linux client (192.168.0.32)

## Creating simple DSC pull server

To create HTTPS Pull server we would need to have SSL certificate generated by our CA.
To find out how to generate a certificate and build CA server please kindly take a look on below links:

https://www.virtuallyboring.com/setup-microsoft-active-directory-certificate-services-ad-cs/

http://duffney.io/Configure-HTTPS-DSC-PullServer (sections: "Creating the Web Cert" and "Exporting & Importing the Web Cert onto the PullServer")

```powershell
##Step 1: Finding and installing needed DSC module module from PowerShell gallery on DSC server or authoring workstation
Find-Module xPSDesiredStateConfiguration | Install-Module
 
##Step 2: Creating DSC Pull Server configuration
configuration Sample_xDscPullServer
{ 
    param  
    ( 
            [string[]]$NodeName = 'localhost', 
 
            [ValidateNotNullOrEmpty()] 
            [string] $certificateThumbPrint,
 
            [Parameter(Mandatory)]
            [ValidateNotNullOrEmpty()]
            [string] $RegistrationKey 
     ) 
 
 
     Import-DSCResource -ModuleName xPSDesiredStateConfiguration
     Import-DSCResource –ModuleName PSDesiredStateConfiguration
 
     Node $NodeName 
     { 
         WindowsFeature DSCServiceFeature 
         { 
             Ensure = 'Present'
             Name   = 'DSC-Service'             
         } 
 
         xDscWebService PSDSCPullServer 
         { 
             Ensure                   = 'Present' 
             EndpointName             = 'PSDSCPullServer' 
             Port                     = 8080 
             PhysicalPath             = "$env:SystemDrive\inetpub\wwwroot\PSDSCPullServer" 
             CertificateThumbPrint    = $certificateThumbPrint          
             ModulePath               = "$env:PROGRAMFILES\WindowsPowerShell\DscService\Modules" 
             ConfigurationPath        = "$env:PROGRAMFILES\WindowsPowerShell\DscService\Configuration" 
             State                    = 'Started'
             DependsOn                = '[WindowsFeature]DSCServiceFeature'     
             UseSecurityBestPractices = $false
         } 
 
        File RegistrationKeyFile
        {
            Ensure          = 'Present'
            Type            = 'File'
            DestinationPath = "$env:ProgramFiles\WindowsPowerShell\DscService\RegistrationKeys.txt"
            Contents        = $RegistrationKey
        }
    }
}
 
###Step 3: Getting all needed variables for DSC Sample_xDscPullServer configuration
$WebCertThumb = (Invoke-Command -Computername labdscps01 {Get-Childitem Cert:\LocalMachine\My | Where-Object {$_.FriendlyName -eq "DSCPSPullServerCert"} | Select-Object -ExpandProperty ThumbPrint})
$Guid = (New-Guid).Guid
 
##Step4: Running Sample_xDscPullServer configuration to create DSC Server MOF file
Sample_xDSCPullServer -certificateThumbprint $WebCertThumb -RegistrationKey $Guid -OutputPath c:\Configs\PullServer
 
##Step5: Applying DSC configration - this steps actually installs DSC pull server 
Start-DscConfiguration -Path c:\Configs\PullServer -Wait -Verbose -Force
```

# This is an h1 tag
```powershell
Write-Host "Siemka"
$p= "Takie Tam"
ForEach ($a in $p) {
Write-Verbose "Bla"
}
```

1. Item 1
1. Item 2
1. Item 3
   1. Item 3a
   1. Item 3b
   
   As Kanye West said:

> We're living the future so
> the present is our past.

I think you should use an
`<addr>` element here instead.

- [x] @mentions, #refs, [links](), **formatting**, and <del>tags</del> supported
- [x] list syntax required (any unordered or ordered list supported)
- [x] this is a complete item
- [ ] this is an incomplete item

First Header | Second Header
------------ | -------------
Content from cell 1 | Content from cell 2
Content in the first column | Content in the second column
